import express from "express";
import * as expressHbs from "express-handlebars";
import path from "path";
import { Request, Response } from "express";
import {HtmlTemplates} from "./index";
import * as billObjects from "./utils/mockData.json";

const app = express();

const hbs = expressHbs.create({
	helpers: {},
	defaultLayout: "layout",
	partialsDir: ["src/views/partials"],
	extname: ".hbs",
});

app.engine(".hbs", hbs.engine);
app.set("view engine", ".hbs");

const viewsDir = path.join(__dirname, "views");
app.set("views", viewsDir);
const staticDir = path.join(__dirname, "public");
app.use(express.static(staticDir));
app.get('/',async (req:Request,res:Response)=>{
	let obj:any =billObjects
	let template=req.query.template || 'temp6';
    res.render("index",{
		data: await HtmlTemplates.getBillTemplateHtml(obj,template)
	});
})

app.listen(9000, () => {
    console.info('Server started on port: ' + 9000);  
});